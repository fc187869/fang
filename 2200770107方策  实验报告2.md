**学院：省级示范性软件学院**

**课程：高级数据库技术与应用**

**题目：**《 实验二：聚合操作练习》

**姓名：**方策

**学号：**2200770107

**班级：**软工2202

**日期：**2024-10-16

**实验环境：**  Kibana

## 一、实验目的：掌握Elasticsearch 聚合操作方法



## 二、实验内容

1. 统计每个产品类别的总销售额。

   ![1   2024-10-16 143607](./1%20%20%202024-10-16%20143607.png)

2. 计算每个城市的平均订单金额。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/2%20%20%202024-10-16%20143727.png)

3. 找出销量最高的前5个产品。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/3%20%202024-10-16%20143904.png)

4. 计算男性和女性客户的平均年龄。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/4%20%202024-10-16%20144004.png)

5. 统计每种支付方式的使用次数和总金额。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/5%20%202024-10-16%20144116.png)

6. 计算每月的总销售额。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/6%20%20%202024-10-16%20144205.png)

7. 找出平均订单金额最高的前3个客户。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/7%20%20%202024-10-16%20144310.png)

8. 计算每个年龄段（18-30，31-50，51+）的客户数量。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/8%20%20%202024-10-16%20144418.png)

9. 计算每个产品类别的平均单价。

   ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/9%20%20%202024-10-16%20144508.png)

10. 找出订单数量最多的前5个城市。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/10%20%202024-10-16%20144546.png)

11. 计算每个季度的平均订单金额。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/11%20%202024-10-16%20144633.png)

12. 统计每个产品类别中的商品数量。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/12%20%202024-10-16%20144738.png)

13. 计算男性和女性客户的平均订单金额。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/13%20%202024-10-16%20144822.png)

14. 找出总销售额最高的前10个日期。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/14%20%202024-10-16%20144907.png)

15. 计算每个季度销售额最高的产品类别。

    ![](./%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0/15%20%202024-10-16%20145035.png)

    

## 三、问题及解决办法